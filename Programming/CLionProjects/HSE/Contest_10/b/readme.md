B. UniquePtr-2
==============

Ограничение времени

1 секунда

Ограничение памяти

64Mb

Ввод

стандартный ввод или input.txt

Вывод

стандартный вывод или output.txt

Модифицируйте свою реализацию класса UniquePtr из предыдущей задачи, добавив к нему Deleter.

Deleter - это функция или объект класса с перегруженным оператором (). Умный указатель вместо выполнения delete для уничтожения объекта должен вызывать эту функцию, передавая ей голый указатель в качестве аргумента. По умолчанию UniquePtr должен использовать тривиальный Deleter, который, как и раньше, вызывает delete (например, std::default\_delete<T>). Но пользователь при желании может передать свой Deleter, который, например, может писать какие-либо логи, или подсчитывать число вызовов, или удалять особым образом память из вручную выделенного пула.

Подробную спецификацию стандартного std::unique\_ptr можно посмотреть на [http://en.cppreference.com/w/cpp/memory/unique\_ptr](http://en.cppreference.com/w/cpp/memory/unique_ptr).

В дополнение к функциям из предыдущей задачи, напишите следующие функции:

1.  Конструктор, принимающий T \* и Deleter.
2.  Константную и неконстантную функцию get\_deleter(), возвращающую соответственно константную и неконстантную ссылку на сохранённый Deleter.

В случае, если класс Deleter'а пустой (не имеет никаких полей и не унаследован от непустых классов), то sizeof вашего UniquePtr не должен превосходить sizeof обычного указателя, и никакой дополнительной динамической памяти выделяться не должно. Проще всего этого достичь, упаковав хранящийся указатель и Deleter в std::tuple, так как большинство реализаций std::tuple используют Empty Base Class Optimization.

Примечания
----------

Сдайте только код самого класса без функции main. Использовать стандартный std::unique\_ptr запрещается.